<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Android_app_room_database | ü™≥ÁöÑDaily Blog WebSite</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="How use local database in app make user experience more comfortable when your app cannot access to the internet. It also can persist data in your local machine. use annotation to create entity @Entity">
<meta property="og:type" content="article">
<meta property="og:title" content="Android_app_room_database">
<meta property="og:url" content="http://fdslk.github.io/tech/kotlin/Android/2023/03/05/Android-app-room-database/index.html">
<meta property="og:site_name" content="ü™≥ÁöÑDaily Blog WebSite">
<meta property="og:description" content="How use local database in app make user experience more comfortable when your app cannot access to the internet. It also can persist data in your local machine. use annotation to create entity @Entity">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-03-05T06:52:54.000Z">
<meta property="article:modified_time" content="2023-03-05T06:54:41.997Z">
<meta property="article:author" content="Zengqiang Fang">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="ü™≥ÁöÑDaily Blog WebSite" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ü™≥ÁöÑDaily Blog WebSite</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://fdslk.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Android-app-room-database" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/tech/kotlin/Android/2023/03/05/Android-app-room-database/" class="article-date">
  <time class="dt-published" datetime="2023-03-05T06:52:54.000Z" itemprop="datePublished">2023-03-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/tech/">tech</a>‚ñ∫<a class="article-category-link" href="/categories/tech/kotlin/">kotlin</a>‚ñ∫<a class="article-category-link" href="/categories/tech/kotlin/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Android_app_room_database
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="How-use-local-database-in-app"><a href="#How-use-local-database-in-app" class="headerlink" title="How use local database in app"></a>How use local database in app</h1><ul>
<li>make user experience more comfortable when your app cannot access to the internet. It also can persist data in your local machine.</li>
<li>use annotation to create entity<ul>
<li><strong>@Entity</strong> for creating table and defining table name</li>
<li><strong>@PrimaryKey</strong> define the primary key</li>
<li><strong>@ColumnInfo</strong> define the column name in the table</li>
</ul>
</li>
<li>use <strong>@Dao</strong> to create query interface: <em><strong>data access object (DAO)</strong></em>, which is used to communicate with local DB<ul>
<li>Dao has provided some basic interface like update, insert, Query, etc.</li>
</ul>
</li>
<li>using <strong>@Database</strong> to create a new database or get a existing database</li>
<li></li>
</ul>
<h2 id="traditional-Factory-to-generate-viewModel"><a href="#traditional-Factory-to-generate-viewModel" class="headerlink" title="traditional Factory to generate viewModel"></a>traditional Factory to generate viewModel</h2><ul>
<li>add viewModel Factory to generate a params passing viewModel</li>
<li>implement <code>ViewModelProvider.Factory</code> interface</li>
<li>override create method</li>
<li>usage<ul>
<li><code>ViewModelProvider(this).get(ViewModel::class.java)</code></li>
</ul>
</li>
<li>tip<ul>
<li>if error occur to you<ul>
<li>Inheritance from an interface with ‚Äò@JvmDefault‚Äô members is only allowed with -Xjvm-default option</li>
<li>add the following section in app leve build.gradle  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    ...</span><br><span class="line">    kotlinOptions &#123;</span><br><span class="line">        ...</span><br><span class="line">        freeCompilerArgs += [</span><br><span class="line">                 &quot;-Xjvm-default=all&quot;,</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="DI-to-generate-viewModel"><a href="#DI-to-generate-viewModel" class="headerlink" title="DI to generate viewModel"></a>DI to generate viewModel</h2><ul>
<li>add dependency in app level build.gradle<ul>
<li>&#96;&#96;&#96;<br>&#x2F;&#x2F; hilt<br>implementation ‚Äúcom.google.dagger:hilt-android:2.38.1‚Äù<br>kapt ‚Äúcom.google.dagger:hilt-android-compiler:2.38.1‚Äù<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* add plugin in app level</span><br><span class="line">  * ```id &#x27;dagger.hilt.android.plugin&#x27;```</span><br><span class="line">* add dependency in project level</span><br><span class="line">  * ```classpath &quot;com.google.dagger:hilt-android-gradle-plugin:2.38.1&quot;```</span><br><span class="line">* add hilt application entry</span><br><span class="line">  ```kotlin</span><br><span class="line">  @HiltAndroidApp</span><br><span class="line">  class MainApplication: Application() &#123;&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>add MainApplication to manifest<br>*<br><code>android:name=&quot;MainApplication&quot;</code></li>
<li>add annotation for viewModel injection <strong>@HiltViewModel</strong></li>
<li>add annotation <strong>@inject</strong> for being injected construct, filed, method, etc.</li>
<li>add annotation <strong>AndroidEntryPoint</strong> in Fragment or Activity who needs to use DI data</li>
<li>add dependency <code>implementation &#39;androidx.fragment:fragment-ktx:1.5.0&#39;</code> in app level for view Model provider<ul>
<li>val viewModel: SleepTrackerViewModel by viewModels()</li>
</ul>
</li>
<li>add custom DI module<ul>
<li>using the <strong>@Module</strong> annotation to mark the class as a DI class</li>
<li>using the <strong>@InstallIn(SingletonComponent::class)</strong> to define provider life cycle</li>
<li>using <strong>@Provides</strong> to annotate the method is related to the specific module</li>
</ul>
</li>
</ul>
<h3 id="coroutines-in-android"><a href="#coroutines-in-android" class="headerlink" title="coroutines in android"></a>coroutines in android</h3><ul>
<li>what is it?<ul>
<li>the way to handle long-running tasks elegantly and efficiently instead of callbacks</li>
<li>like callback to process task in asynchronous and non-block way</li>
<li>use <code>suspend</code> keyword for making asynchronous code in sequential way</li>
<li>architecture<ul>
<li>Job: using for operating coroutine</li>
<li>Dispatcher: make coroutines run in different threads</li>
<li>Scope: define which context the coroutines runs</li>
</ul>
</li>
<li><strong>why coroutines is safe and how?</strong></li>
</ul>
</li>
<li>How to use it?<ul>
<li>add <strong>suspend</strong> in the front of a function signature in Dao</li>
<li>add coroutine dependency in app level build.gradle<ul>
<li>implementation ‚Äúandroidx.lifecycle:lifecycle-viewmodel-ktx:2.2.0‚Äù</li>
<li>implementation ‚Äúandroidx.room:room-ktx:$room_version‚Äù</li>
</ul>
</li>
<li>define MutableLiveData variable and init it by viewModeScope.launch starting a coroutine in current viewModel</li>
</ul>
</li>
<li>Using it for long-running database</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://github.com/Fdslk/KotlinRepository/tree/main/TrackMySleepQuality">Room database</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://fdslk.github.io/tech/kotlin/Android/2023/03/05/Android-app-room-database/" data-id="clev2anat0004j8hs4munblwx" data-title="Android_app_room_database" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/tech/ops/CD/2023/03/05/ops-argocd/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          ops_argocd
        
      </div>
    </a>
  
  
    <a href="/tech/kotlin/Android/2023/03/05/Android-app-liveData-viewModel/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Android_app_liveData_viewModel</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/">tech</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/dotnet-core/">dotnet-core</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/java/">java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/java/design-pattern/">design-pattern</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/java/lint/">lint</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/java/spring-boot/">spring-boot</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/java/spring-boot/101/">101</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/java/spring-boot/auth0/">auth0</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/java/spring-boot/jwt/">jwt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/java/spring-boot/starter/">starter</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/java/spring-boot/webflux/">webflux</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/java/swagger/">swagger</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/java/swagger/open-api/">open-api</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/kotlin/">kotlin</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/kotlin/101/">101</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/kotlin/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/kotlin/idea-pulgins/">idea pulgins</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/ops/">ops</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/ops/CD/">CD</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/ops/cache/">cache</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/ops/k8s/">k8s</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/ops/k8s/secret/">secret</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/ops/log/">log</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/ops/package/">package</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/shell/">shell</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/test/">test</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/test/gatling/">gatling</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/test/java/">java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/test/java/es/">es</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/video/">video</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/video/ffmpeg/">ffmpeg</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/techt/">techt</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/techt/java/">java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/techt/java/java-feature-option-optional/">java feature option-optional</a></li></ul></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/elastic-search-java-test/" rel="tag">elastic search, java, test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/es/" rel="tag">es</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ffmpeg/" rel="tag">ffmpeg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ffmpeg-coverting-format/" rel="tag">ffmpeg, coverting format</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ffmpeg-media-server/" rel="tag">ffmpeg, media-server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java-design-pattern-easy-rule/" rel="tag">java, design-pattern, easy-rule</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java-lint/" rel="tag">java, lint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java-spring-customer-starter/" rel="tag">java, spring, customer-starter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java-spring-boot-auth0/" rel="tag">java, spring-boot, auth0</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/elastic-search-java-test/" style="font-size: 10px;">elastic search, java, test</a> <a href="/tags/es/" style="font-size: 10px;">es</a> <a href="/tags/ffmpeg/" style="font-size: 10px;">ffmpeg</a> <a href="/tags/ffmpeg-coverting-format/" style="font-size: 10px;">ffmpeg, coverting format</a> <a href="/tags/ffmpeg-media-server/" style="font-size: 10px;">ffmpeg, media-server</a> <a href="/tags/java-design-pattern-easy-rule/" style="font-size: 10px;">java, design-pattern, easy-rule</a> <a href="/tags/java-lint/" style="font-size: 10px;">java, lint</a> <a href="/tags/java-spring-customer-starter/" style="font-size: 10px;">java, spring, customer-starter</a> <a href="/tags/java-spring-boot-auth0/" style="font-size: 10px;">java, spring-boot, auth0</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/tech/dotnet-core/2023/03/05/dotnet-core-related/">dotnet_core_related</a>
          </li>
        
          <li>
            <a href="/tech/test/gatling/2023/03/05/gatling-load-test/">gatling_load_test</a>
          </li>
        
          <li>
            <a href="/tech/test/gatling/2023/03/05/gatling-101/">gatling_101</a>
          </li>
        
          <li>
            <a href="/tech/shell/2023/03/05/shell-disk-operation/">shell_disk_operation</a>
          </li>
        
          <li>
            <a href="/tech/shell/2023/03/05/shell-file-operation/">shell_file_operation</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 Zengqiang Fang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>